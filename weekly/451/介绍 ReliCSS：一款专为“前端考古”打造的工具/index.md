# 介绍 ReliCSS：一款专为“前端考古”打造的工具

> 原文：[Introducing ReliCSS: A Tool for Front-End Archaeology](https://www.alwaystwisted.com/articles/introducing-relicss-a-tool-for-front-end-archaeology)
>
> 翻译：[嘿嘿](https://blog.heyfe.org/blog)

作为一名外包前端开发和设计系统（Design Systems）顾问，我并不总是能有机会从零开始做新项目。

很多时候，我需要深入现有的代码库工作，或者在它们的基础上进行扩展。而这些代码库，有的已经存在很多很多年了。

当你扎进这些项目时，你不仅仅是在阅读代码，更是在挖掘过去数年里沉淀下来的决策、技术局限以及当时的各种奇技淫巧。在过去的十年里，我把这种行为称为“前端考古（Front-End Archaeology）”。

## 挖掘的艺术

当我遇到 `clearfix` 技巧时，我看到的是那个布局引擎还无法自动包含浮动元素的时代。当我看到“双倍浮动边距 bug（doubled float margin bug）”的修复代码时，我见证了 Internet Explorer 6 留下的“伤疤”。每一个特定厂商的前缀（Vendor Prefix）、每一个浏览器 Hack，以及每一个奇怪的 `!important` 规则，都在讲述着一个开发者如何在时代的束缚下奋力挣扎，只为交付一个能正常运行的产品的故事。

用现代的标准去审视并批判旧代码很容易，但“前端考古”需要的是同理心和好奇心。它不仅仅在问“我该怎么删掉这段代码？”，更是在探寻“为什么当时必须这么写？”以及“我们可以从中吸取什么教训？”。

前端考古非常耗时。手动识别这些“文物”需要对浏览器兼容性的历史演进有深入的了解，而许多现代开发者（庆幸的是）已经不再需要学习这些古老的怪癖了。这时候，工具的重要性就体现出来了。

## 用 ReliCSS 发掘历史

为了协助这场考古探险，我开发了一个工具：[ReliCSS](https://www.alwaystwisted.com/relicss/)。

![ReliCSS 界面展示了 CSS 扫描器，包含代码输入区和显示浏览器 Hack 严重程度的结果页](./assets/ReliCSS-interface-screenshot.jpg)

ReliCSS 是你“挖掘”过程中的助手。它是一个专门的扫描器，通过分析 CSS 来识别那些散落在旧样式表中的历史遗迹或“浏览器 Hack”。

无论你是为了重构而审计遗留代码库，还是纯粹好奇项目样式表中的历史痕迹，ReliCSS 都能帮你发现那些“机器里的幽灵”。

### 它是如何工作的

目前，你可以直接将 CSS 粘贴到 ReliCSS 中，它会进行解析并高亮显示发现的所有浏览器 Hack。

针对每一个“Hack”，ReliCSS 都会告诉你它的目标浏览器、上下文背景，并提供一些现代化的改进建议。ReliCSS 还分配了**严重程度（Severity Level）**，帮你确定重构的优先级，明确哪些可以删、哪些必须删：

*   **高严重程度（High Severity）：** 真正的“化石”。针对已不再受支持的浏览器（如 IE6/7）的 Hack，或是一些“危险”的技术。这些代码风险高、已过时，应该是首要清理目标。
*   **中严重程度（Medium Severity）：** 过渡地带。针对较旧但已停止支持的浏览器（如 IE8-10）的 Hack。它们虽然有效但很脆弱。建议审查这些 Hack，看看对你的实际用户是否还有意义。
*   **低严重程度（Low Severity）：** 现代遗迹。通常是厂商前缀（如 `-webkit-`、`-moz-`）。它们大多是安全的，但最好交给 Autoprefixer 等自动化工具处理。这是优化构建流程的一个契机。

我在开发 ReliCSS 时，考虑到外包商和顾问可能会接触到敏感的客户代码，因此让它完全在浏览器中运行。当你点击“扫描 CSS”时，分析过程全部发生在本地。没有任何代码会被发送到服务器或其他地方，你可以放心地粘贴 CSS，无需担心数据泄露。

## 路线图：未来的挖掘工具

如前所述，目前 ReliCSS 依赖手动粘贴代码。但我正在考虑增加和改进一些功能，以下是计划中的内容：

*   **拖拽上传：** 直接将 `.css` 文件拖入工具进行即时扫描。
*   **URL 抓取：** 给 ReliCSS 一个在线样式表的链接，让它自动提取并分析。
*   **命令行界面（CLI）：** 这是“重头戏”。我正在努力将 ReliCSS 带入终端。届时，你可以编写考古脚本，将这些检查集成到构建流水线或本地开发环境中，在这些 Hack 被再次“埋没”之前就抓住它们。

## 从考古到现代化

前端考古不只是为了欣赏废墟，更是为了能在其之上更安全地构建。ReliCSS 弥合了过去与现在之间的鸿沟。它能帮你自信地分辨哪些是支撑业务的核心代码，哪些只是历史的糟粕。

通过识别哪些 CSS 仅仅是为了支持 2006 年的浏览器而存在，你可以明智地决定哪些该保留、哪些该重构、哪些该删除。它能将枯燥繁琐的遗留 CSS 重构任务，转变为一次关于 Web 历史的生动学习体验。

如果你发现自己正盯着一份看起来像是从“浏览器战争”中幸存下来的样式表，不妨试试 [ReliCSS](https://www.alwaystwisted.com/relicss/)。你可能会了解到它的前世今生，并能更轻松地将它带向未来。